# Environment Variables and PATH Configuration
# This file sets up environment variables and modifies PATH
# Uses Chezmoi templating for cross-platform compatibility

# Editor and visual settings
export EDITOR="nvim"
export VISUAL="nvim"

# Language and locale settings
export LANG="en_US.UTF-8"
export LC_ALL="en_US.UTF-8"

# Terminal settings
export TERM="xterm-256color"

# History settings (complement the common.zsh settings)
export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S "

# Less settings for better pager experience
export LESS="-R --use-color -Dd+r$Du+b"
export PAGER="less"

# Grep settings
export GREP_COLORS="mt=1;33:fn=1;32:ln=1;36:se=1;35"

# macOS-specific environment variables
{{ if eq .chezmoi.os "darwin" -}}
# Homebrew settings
export HOMEBREW_NO_AUTO_UPDATE=1
export HOMEBREW_NO_ENV_HINTS=1

# macOS-specific paths
export PATH="/opt/homebrew/bin:/opt/homebrew/sbin:$PATH"
export PATH="/usr/local/bin:/usr/local/sbin:$PATH"

# Library paths
export LDFLAGS="-L/opt/homebrew/lib"
export CPPFLAGS="-I/opt/homebrew/include"

# Python settings
export PYTHONPATH="/opt/homebrew/lib/python3.11/site-packages:$PYTHONPATH"

# Node.js settings
#export NPM_CONFIG_PREFIX="$HOME/.npm-global"
#export PATH="$NPM_CONFIG_PREFIX/bin:$PATH"

# Go settings
export GOPATH="$HOME/go"
export GOROOT="/opt/homebrew/opt/go/libexec"
export PATH="$GOPATH/bin:$PATH"

# Rust settings
export PATH="$HOME/.cargo/bin:$PATH"

# Java settings (if installed)
export JAVA_HOME="/opt/homebrew/opt/openjdk/libexec/openjdk.jdk/Contents/Home"
export PATH="$JAVA_HOME/bin:$PATH"

# Android SDK (if installed)
export ANDROID_HOME="$HOME/Library/Android/sdk"
export PATH="$ANDROID_HOME/tools:$ANDROID_HOME/tools/bin:$ANDROID_HOME/platform-tools:$PATH"

# Flutter (if installed)
export FLUTTER_HOME="$HOME/flutter"
export PATH="$FLUTTER_HOME/bin:$PATH"
{{ end -}}

# Linux-specific environment variables
{{ if eq .chezmoi.os "linux" -}}
# Linux-specific paths
export PATH="/usr/local/bin:/usr/local/sbin:$PATH"
export PATH="$HOME/.local/bin:$PATH"

# Python settings
export PYTHONPATH="$HOME/.local/lib/python3.11/site-packages:$PYTHONPATH"
export PIP_USER=yes
export PIP_CACHE_DIR="$HOME/.cache/pip"

# Node.js settings
# export NPM_CONFIG_PREFIX="$HOME/.npm-global"
# export PATH="$NPM_CONFIG_PREFIX/bin:$PATH"

# Go settings
export GOPATH="$HOME/go"
export GOROOT="/usr/local/go"
export PATH="$GOPATH/bin:$PATH"

# Rust settings
export PATH="$HOME/.cargo/bin:$PATH"

# Java settings (if installed)
export JAVA_HOME="/usr/lib/jvm/default"
export PATH="$JAVA_HOME/bin:$PATH"

# Docker settings
export DOCKER_BUILDKIT=1

# XDG Base Directory specification
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_DATA_HOME="$HOME/.local/share"
export XDG_CACHE_HOME="$HOME/.cache"
{{ end -}}

# Language-specific settings (common across platforms)

# Node.js Version Manager (nvm)
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

# Python Version Manager (pyenv)
export PYENV_ROOT="$HOME/.pyenv"
export PATH="$PYENV_ROOT/bin:$PATH"
if command -v pyenv 1>/dev/null 2>&1; then
    eval "$(pyenv init --path)"
    eval "$(pyenv init -)"
fi

# Ruby Version Manager (rbenv)
export RBENV_ROOT="$HOME/.rbenv"
export PATH="$RBENV_ROOT/bin:$PATH"
if command -v rbenv 1>/dev/null 2>&1; then
    eval "$(rbenv init - zsh)"
fi

# Package manager paths

# Yarn
{{ if lookPath "yarn" -}}
export PATH="$(yarn global bin):$PATH"
{{ end -}}

# pnpm
export PNPM_HOME="$HOME/.local/share/pnpm"
export PATH="$PNPM_HOME:$PATH"

# Bun
export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"

# Development-specific settings

# Database settings
export PGHOST="localhost"
export PGUSER="postgres"

# AWS settings (if using AWS CLI)
{{ if .is_work -}}
export AWS_DEFAULT_REGION="us-east-1"
export AWS_PROFILE="work"
{{ else -}}
export AWS_DEFAULT_REGION="us-east-1"
export AWS_PROFILE="personal"
{{ end -}}

# Terraform settings
export TF_PLUGIN_CACHE_DIR="$HOME/.terraform.d/plugin-cache"
export TF_CLI_CONFIG_FILE="$HOME/.terraformrc"

# Kubernetes settings
export KUBECONFIG="$HOME/.kube/config"
export KUBERNETES_MASTER=""

# Docker settings
export DOCKER_CONFIG="$HOME/.docker"
export COMPOSE_DOCKER_CLI_BUILD=1

# Security settings
export GPG_TTY=$(tty)

# Temporary files
export TMPDIR="/tmp"
export TEMP="/tmp"
export TMP="/tmp"

# Custom environment variables
export DOTFILES_DIR="$HOME/.local/share/chezmoi"
export SCRIPTS_DIR="$HOME/.local/bin"

# Add custom scripts to PATH
export PATH="$SCRIPTS_DIR:$PATH"

# Final PATH cleanup (remove duplicates)
export PATH=$(echo "$PATH" | tr ':' '\n' | sort -u | tr '\n' ':' | sed 's/:$//')
